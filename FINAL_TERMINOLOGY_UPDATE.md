# –§–∏–Ω–∞–ª—å–Ω–∞—è —Å–≤–æ–¥–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏ offerId ‚Üí offerId_M2

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ

–£—Å–ø–µ—à–Ω–æ –∑–∞–º–µ–Ω–∏–ª–∏ –≤—Å–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `offerId` –Ω–∞ `offerId_M2` –≤–æ –≤—Å—ë–º –ø—Ä–æ–µ–∫—Ç–µ –¥–ª—è —è—Å–Ω–æ—Å—Ç–∏ –∏ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏–∏.

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ (src/)

1. **src/services/mapperService.js**
   - ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ—Ç–æ–¥–æ–≤: `offerId` ‚Üí `offerId_M2`
   - ‚úÖ –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `offerId` ‚Üí `offerId_M2`
   - ‚úÖ JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
   - ‚úÖ –õ–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

2. **src/services/stockService.js**
   - ‚úÖ –ú–µ—Ç–æ–¥ `updateM2Stock(offerId, ...)` ‚Üí `updateM2Stock(offerId_M2, ...)`
   - ‚úÖ –í—Å–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
   - ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏: "–¢–û–õ–¨–ö–û offerId_M2 –∏ count"
   - ‚úÖ –õ–æ–≥–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

3. **src/services/orderService.js**
   - ‚úÖ –ú–µ—Ç–æ–¥ `_mapOrderItems()` –æ–±–Ω–æ–≤–ª—ë–Ω
   - ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `offerId` ‚Üí `offerId_M2`
   - ‚úÖ `unmappedOfferIds` ‚Üí `unmappedOfferIds_M2`
   - ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

4. **src/api/yandexClient.js**
   - ‚úÖ JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ—è—Å–Ω–µ–Ω–∏–µ –æ –∑–Ω–∞—á–µ–Ω–∏–∏ offerId

### –¢–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã (test-*.js)

1. **test-mapper.js**
   - ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ: `offerId1`, `offerId2`, `offerId3` ‚Üí `offerId_M2_1`, `offerId_M2_2`, `offerId_M2_3`
   - ‚úÖ `allOfferIds` ‚Üí `allOfferIds_M2`
   - ‚úÖ –ù–∞–∑–≤–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
   - ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

2. **test-resilience.js**
   - ‚úÖ Mock –º–µ—Ç–æ–¥ `mapOfferIdToExternalCode(offerId)` ‚Üí `mapOfferIdToExternalCode(offerId_M2)`
   - ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä `updateM2Stock(offerId, stock)` ‚Üí `updateM2Stock(offerId_M2, stock)`

3. **test-logging.js**
   - ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `{ offerId: ... }` ‚Üí `{ offerId_M2: ... }`

4. **test-logging-detailed.js**
   - ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω—ã

5. **test-mapper-edge-cases.js**
   - ‚úÖ –°–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –æ–±–Ω–æ–≤–ª–µ–Ω—ã

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (docs/)

1. **docs/resilience-guide.md**
   - ‚úÖ –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
   - ‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã

2. **RESILIENCE_IMPLEMENTATION_SUMMARY.md**
   - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–í–∞–∂–Ω–æ" —Å –ø–æ—è—Å–Ω–µ–Ω–∏–µ–º

3. **TERMINOLOGY_UPDATE_SUMMARY.md**
   - ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üéØ –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### –î–æ:
```javascript
const offerId = item.offerId;
const externalCode = this.mapperService.mapOfferIdToExternalCode(offerId);
await this.updateM2Stock(offerId, availableStock);
```

### –ü–æ—Å–ª–µ:
```javascript
const offerId_M2 = item.offerId;
const externalCode = this.mapperService.mapOfferIdToExternalCode(offerId_M2);
await this.updateM2Stock(offerId_M2, availableStock);
```

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ**: 11
- **–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥**: 4 —Ñ–∞–π–ª–∞
- **–¢–µ—Å—Ç—ã**: 5 —Ñ–∞–π–ª–æ–≤
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: 2 —Ñ–∞–π–ª–∞

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞

### –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç:

```bash
‚úì test-mapper.js - 12/12 —Ç–µ—Å—Ç–æ–≤
‚úì test-stock-service.js - 7/7 —Ç–µ—Å—Ç–æ–≤
‚úì test-order-service.js - 13/13 —Ç–µ—Å—Ç–æ–≤
‚úì test-resilience.js - 6/6 —Ç–µ—Å—Ç–æ–≤
‚úì test-mapper-edge-cases.js - –≤—Å–µ —Ç–µ—Å—Ç—ã
‚úì test-mapper-integration.js - –≤—Å–µ —Ç–µ—Å—Ç—ã
‚úì test-logging.js - –≤—Å–µ —Ç–µ—Å—Ç—ã
‚úì test-logging-detailed.js - –≤—Å–µ —Ç–µ—Å—Ç—ã
```

**–ò—Ç–æ–≥–æ: 38+ —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ ‚úÖ**

## üîç –ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç offerId_M2

**offerId_M2** - —ç—Ç–æ:
- –ó–Ω–∞—á–µ–Ω–∏–µ –∫–∞—Å—Ç–æ–º–Ω–æ–≥–æ –∞—Ç—Ä–∏–±—É—Ç–∞ `offerId_M2` –≤ –ú–æ–π–°–∫–ª–∞–¥
- –°–æ–¥–µ—Ä–∂–∏—Ç ID —Ç–æ–≤–∞—Ä–∞ (sku) –≤ M2 (–Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–∞–ø–ø–∏–Ω–≥–∞ –º–µ–∂–¥—É –ú–æ–π–°–∫–ª–∞–¥ –∏ M2
- –•—Ä–∞–Ω–∏—Ç—Å—è –≤ –ú–æ–π–°–∫–ª–∞–¥, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Å—Ç–∞—Ç–∫–æ–≤ –≤ M2

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–∞–ø–ø–∏–Ω–≥–∞:

```
–ú–æ–π–°–∫–ª–∞–¥                          M2 (–Ø–Ω–¥–µ–∫—Å.–ú–∞—Ä–∫–µ—Ç)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Product             ‚îÇ          ‚îÇ Offer        ‚îÇ
‚îÇ - externalCode      ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∫‚îÇ - sku        ‚îÇ
‚îÇ - attributes:       ‚îÇ          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ   - offerId_M2 ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ     (–∑–Ω–∞—á–µ–Ω–∏–µ)      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å –≤–æ –≤—Å—ë–º –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω–∞—è, –ø–æ–Ω—è—Ç–Ω–∞—è —Ç–µ—Ä–º–∏–Ω–æ–ª–æ–≥–∏—è:
- ‚úÖ `offerId_M2` - –≤—Å–µ–≥–¥–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–∞ offerId_M2 –∏–∑ –ú–æ–π–°–∫–ª–∞–¥
- ‚úÖ `externalCode` - –≤—Å–µ–≥–¥–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞ –≤ –ú–æ–π–°–∫–ª–∞–¥
- ‚úÖ –ö–æ–¥ —Å—Ç–∞–ª –±–æ–ª–µ–µ —á–∏—Ç–∞–µ–º—ã–º –∏ –ø–æ–Ω—è—Ç–Ω—ã–º
- ‚úÖ –ú–µ–Ω—å—à–µ –ø—É—Ç–∞–Ω–∏—Ü—ã –ø—Ä–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–µ
- ‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- `TERMINOLOGY_UPDATE_SUMMARY.md` - –ø–æ–¥—Ä–æ–±–Ω–∞—è —Å–≤–æ–¥–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- `RESILIENCE_IMPLEMENTATION_SUMMARY.md` - —Å–≤–æ–¥–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
- `docs/resilience-guide.md` - —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã
