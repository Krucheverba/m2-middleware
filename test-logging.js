/**
 * –¢–µ—Å—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
 * –ü—Ä–æ–≤–µ—Ä—è–µ—Ç: –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è 6.1, 6.2, 6.3, 6.4, 6.5, 7.3
 */

// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞
process.env.YANDEX_CAMPAIGN_ID = 'test-campaign';
process.env.YANDEX_TOKEN = 'test-token';
process.env.MS_TOKEN = 'test-ms-token';
process.env.MS_BASE = 'https://api.moysklad.ru/api/remap/1.2';
process.env.LOG_LEVEL = 'error';

const logger = require('./src/logger');

console.log('üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è...\n');

// –¢–µ—Å—Ç 1: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –º–∞–ø–ø–∏–Ω–≥–∞ (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 6.1)
console.log('‚úì –¢–µ—Å—Ç 1: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –º–∞–ø–ø–∏–Ω–≥–∞');
logger.logMappingError(
  '–ú–∞–ø–ø–∏–Ω–≥ –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è offerId_M2',
  { offerId_M2: 'TEST-OFFER-123', externalCode: 'TEST-EXT-456' }
);
console.log('  –õ–æ–≥ –æ—à–∏–±–∫–∏ –º–∞–ø–ø–∏–Ω–≥–∞ —Å–æ–∑–¥–∞–Ω —Å –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏\n');

// –¢–µ—Å—Ç 2: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ API (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 6.2)
console.log('‚úì –¢–µ—Å—Ç 2: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ API');
logger.logApiError(
  '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤',
  { endpoint: '/entity/product', method: 'GET', params: { limit: 100 } },
  { status: 500, message: 'Internal Server Error' },
  new Error('Connection timeout')
);
console.log('  –õ–æ–≥ –æ—à–∏–±–∫–∏ API —Å–æ–∑–¥–∞–Ω —Å –¥–µ—Ç–∞–ª—è–º–∏ –∑–∞–ø—Ä–æ—Å–∞ –∏ –æ—Ç–≤–µ—Ç–∞\n');

// –¢–µ—Å—Ç 3: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
console.log('‚úì –¢–µ—Å—Ç 3: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Ñ–∞–π–ª–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π');
logger.logFileError(
  '–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–∞–ø–ø–∏–Ω–≥ –∑–∞–∫–∞–∑–∞',
  './data/order-mappings.json',
  'save',
  new Error('EACCES: permission denied')
);
console.log('  –õ–æ–≥ –æ—à–∏–±–∫–∏ —Ñ–∞–π–ª–∞ —Å–æ–∑–¥–∞–Ω —Å –ø—É—Ç—ë–º –∏ –æ–ø–µ—Ä–∞—Ü–∏–µ–π\n');

// –¢–µ—Å—Ç 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ webhook
console.log('‚úì –¢–µ—Å—Ç 4: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ webhook');
logger.logWebhookError(
  '–ù–µ–≤–∞–ª–∏–¥–Ω—ã–π webhook –æ—Ç–∫–ª–æ–Ω—ë–Ω',
  { action: 'UPDATE', entityType: 'product' },
  new Error('Invalid signature')
);
console.log('  –õ–æ–≥ –æ—à–∏–±–∫–∏ webhook —Å–æ–∑–¥–∞–Ω —Å –¥–∞–Ω–Ω—ã–º–∏ webhook\n');

// –¢–µ—Å—Ç 5: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∑–∞–∫–∞–∑–æ–≤ (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 6.3)
console.log('‚úì –¢–µ—Å—Ç 5: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∑–∞–∫–∞–∑–æ–≤');
logger.logOrderError(
  '–ó–∞–∫–∞–∑ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã',
  'M2-ORDER-789',
  ['OFFER-001', 'OFFER-002', 'OFFER-003']
);
console.log('  –õ–æ–≥ –æ—à–∏–±–∫–∏ –∑–∞–∫–∞–∑–∞ —Å–æ–∑–¥–∞–Ω —Å ID –∑–∞–∫–∞–∑–∞ –∏ —Å–ø–∏—Å–∫–æ–º –Ω–µ–º–∞–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤\n');

// –¢–µ—Å—Ç 6: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
console.log('‚úì –¢–µ—Å—Ç 6: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏');
logger.logSyncError(
  '–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–∞',
  'stock',
  { externalCode: 'EXT-123', offerId_M2: 'OFFER-456' },
  new Error('Rate limit exceeded')
);
console.log('  –õ–æ–≥ –æ—à–∏–±–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω —Å —Ç–∏–ø–æ–º –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º\n');

// –¢–µ—Å—Ç 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 7.3)
console.log('‚úì –¢–µ—Å—Ç 7: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏ —É—á—ë—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö');
logger.error('–¢–µ—Å—Ç —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏', {
  MS_TOKEN: 'secret-token-123',
  YANDEX_TOKEN: 'another-secret-456',
  authorization: 'Bearer secret-789',
  normalField: 'this-should-be-visible'
});
console.log('  –£—á—ë—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–∞ [REDACTED]\n');

// –¢–µ—Å—Ç 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ª–æ–≥–æ–≤ (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 6.4)
console.log('‚úì –¢–µ—Å—Ç 8: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ª–æ–≥–æ–≤');
logger.error('–¢–µ—Å—Ç–æ–≤–∞—è –æ—à–∏–±–∫–∞ —Å–æ –≤—Å–µ–º–∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º–∏ –ø–æ–ª—è–º–∏', {
  errorType: 'TEST_ERROR',
  identifiers: { testId: '123' },
  timestamp: new Date().toISOString()
});
console.log('  –õ–æ–≥ —Å–æ–¥–µ—Ä–∂–∏—Ç timestamp, errorType –∏ identifiers\n');

// –¢–µ—Å—Ç 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (–¢—Ä–µ–±–æ–≤–∞–Ω–∏–µ 6.5, 7.5)
console.log('‚úì –¢–µ—Å—Ç 9: –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–≤–Ω–µ–π –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è');
console.log(`  –¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: ${process.env.LOG_LEVEL || 'error'}`);
logger.info('–≠—Ç–æ info —Å–æ–æ–±—â–µ–Ω–∏–µ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ LOG_LEVEL=info');
logger.warn('–≠—Ç–æ warn —Å–æ–æ–±—â–µ–Ω–∏–µ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ –µ—Å–ª–∏ LOG_LEVEL=warn –∏–ª–∏ info');
logger.error('–≠—Ç–æ error —Å–æ–æ–±—â–µ–Ω–∏–µ - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–∏–¥–Ω–æ –≤—Å–µ–≥–¥–∞');
console.log('  –õ–æ–≥–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è —Å–æ–≥–ª–∞—Å–Ω–æ —É—Ä–æ–≤–Ω—é LOG_LEVEL\n');

// –¢–µ—Å—Ç 10: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
console.log('‚úì –¢–µ—Å—Ç 10: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è');
logger.debug('Debug —Å–æ–æ–±—â–µ–Ω–∏–µ', { detail: 'test' });
logger.info('Info —Å–æ–æ–±—â–µ–Ω–∏–µ', { detail: 'test' });
logger.warn('Warning —Å–æ–æ–±—â–µ–Ω–∏–µ', { detail: 'test' });
logger.error('Error —Å–æ–æ–±—â–µ–Ω–∏–µ', { detail: 'test' });
console.log('  –í—Å–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç\n');

console.log('‚úÖ –í—Å–µ —Ç–µ—Å—Ç—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!');
console.log('\nüìù –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∞–π–ª—ã logs/error.log –∏ logs/combined.log');
console.log('   –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è —á—Ç–æ –ª–æ–≥–∏ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.');
